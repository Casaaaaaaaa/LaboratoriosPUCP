{% extends 'internal/base_internal.html' %}

{% block title %}{{ super() }} | Solicitudes{% endblock title %}

{% block custom_css %}{% endblock custom_css %}

{% block page_content %}
<div class="row border-bottom white-bg dashboard-header">
  <div class="col-md-6">
    <h2><strong>Modificar Solicitud</strong></h2>
  </div>
</div>

<div class="wrapper wrapper-content animated fadeInRight">
  <div class="col-lg-12">
    <div class="ibox float-e-margins">
      <div class="ibox-content">
        {{ form.errors }}
        <form id='requestform' action="{{ url('internal:servicerequest.edit',pk=pk) }}" method="post" data-toggle="validator">
          {% csrf_token %}
          {% for field in form %}
            <div class="row">
              <div class="col-lg-6">
                <div class="form-group">
                  <label>{{ field.label }} {% if field.field.required %}(*){% endif %}</label>
                  <div required data-error="El" {{field.label}} " es obligatorio" placeholder="------">
                    {{ field }}
                  </div>
                <div class="help-block with-errors"></div>
              </div>
            </div>
          </div>
          {% endfor %}
        </form>
        {% for sample in samples %}
        <div class="row">
          <div class="col-lg-12">
            <table class="table table-bordered table-hover">
              <thead>
                <tr>
                  <th>Id</th>
                  <th>Muestra</th>
                  <th>Tipo de Muestra</th>
                  <th>Nombre de Ensayo: {{ essays[loop.index-1] }}</th>
                  <th>Editar/Eliminar</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>{{ sample.id }}</td>
                  <td>{{ sample.name }}</td>
                  <td>{{ sample.sample_type.name }}</td>
                  <td>
                    <table class="table table-bordered table-hover">
                      <thead>
                        <tr>
                          {% for essay_method_fill in essays_methods[loop.index-1] %}
                          <th>{{ essay_method_fill.essay_method.name }}</th>
                          {% endfor %}
                        </tr>
                      </thead>
                      <tbody>
                        <tr>
                          {% for essay_method_active in essay_methods_chosen_forms[loop.index-1] %}
                          <td>{{ essay_method_active.as_p()}}</td>
                          {% endfor%}
                        </tr>
                      </tbody>
                    </table>
                  </td>
                  <td>
                    <a class="btn-white btn btn-xs" href="{{ url('internal:servicerequest.edit_sample',pk,sample.id) }}">Editar</a>
                    <a class="btn-white btn btn-xs" href="{{ url('internal:servicerequest.delete_sample',pk,sample.id) }}">Eliminar</a>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        {% endfor %}
        <div class="row">
          <div class="col-lg-6 col-lg-offset-3">
            <div class="text-center">
              <input type="submit" value="Registrar" class="btn btn-primary" form="requestform">
              <a href="{{ url('internal:servicerequest.add_sample',pk)}}" class="btn btn-primary">AÃ±adir Prueba</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock page_content %}
